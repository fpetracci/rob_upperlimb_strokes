function [ gWorldE1 ] = gWorldE1fun( par, angles )
%UNTITLED3 Summary of this function goes here
%   Detailed explanation goes here

 DX = par(1);
 DY = par(2);
 DZ = par(3);
 
 DX1 = par(4);
 DY1 = par(5);
 DZ1 = par(6);
 
 DX2 = par(7);
 DY2 = par(8);
 DZ2 = par(9);

 DX3 = par(10);
 DY3 = par(11);
 DZ3 = par(12);
 
 L1 = par(13);
 L2 = par(14);
 Suppx = par(15);
 Suppy = par(16);
 
 q1 = angles(1);
 q2 = angles(2); 
 q3 = angles(3);
 q4 = angles(4); 
 q5 = angles(5); 
 q6 = angles(6);
 q7 = angles(7); 

gWorldE1=[cos(q1).*cos(q3)+(-1).*sin(q1).*sin(q2).*sin(q3),(-1).*cos(q2).*cos(q4) ...
  .*sin(q1)+(cos(q3).*sin(q1).*sin(q2)+cos(q1).*sin(q3)).*sin(q4),cos(q4) ...
  .*(cos(q3).*sin(q1).*sin(q2)+cos(q1).*sin(q3))+cos(q2).*sin(q1).*sin(q4) ...
  ,DX.*(1+(-1).*cos(q1))+DY.*sin(q1)+(-1).*sin(q1).*(DY.*(1+(-1).*cos(q2)) ...
  +DZ.*sin(q2))+sin(q1).*sin(q2).*(DZ.*(1+(-1).*cos(q3))+DX.*sin(q3))+cos( ...
  q1).*(DX.*(1+(-1).*cos(q3))+(-1).*DZ.*sin(q3))+DX.*(cos(q1).*cos(q3)+( ...
  -1).*sin(q1).*sin(q2).*sin(q3))+(cos(q3).*sin(q1).*sin(q2)+cos(q1).*sin( ...
  q3)).*((DZ+L1).*(1+(-1).*cos(q4))+(-1).*DY.*sin(q4))+(-1).*cos(q2).*sin( ...
  q1).*(DY.*(1+(-1).*cos(q4))+(DZ+L1).*sin(q4))+(DZ+L1).*(cos(q4).*(cos( ...
  q3).*sin(q1).*sin(q2)+cos(q1).*sin(q3))+cos(q2).*sin(q1).*sin(q4))+DY.*( ...
  (-1).*cos(q2).*cos(q4).*sin(q1)+(cos(q3).*sin(q1).*sin(q2)+cos(q1).*sin( ...
  q3)).*sin(q4));cos(q3).*sin(q1)+cos(q1).*sin(q2).*sin(q3),cos(q1).*cos( ...
  q2).*cos(q4)+((-1).*cos(q1).*cos(q3).*sin(q2)+sin(q1).*sin(q3)).*sin(q4) ...
  ,cos(q4).*((-1).*cos(q1).*cos(q3).*sin(q2)+sin(q1).*sin(q3))+(-1).*cos( ...
  q1).*cos(q2).*sin(q4),DY.*(1+(-1).*cos(q1))+(-1).*DX.*sin(q1)+cos(q1).*( ...
  DY.*(1+(-1).*cos(q2))+DZ.*sin(q2))+(-1).*cos(q1).*sin(q2).*(DZ.*(1+(-1) ...
  .*cos(q3))+DX.*sin(q3))+sin(q1).*(DX.*(1+(-1).*cos(q3))+(-1).*DZ.*sin( ...
  q3))+DX.*(cos(q3).*sin(q1)+cos(q1).*sin(q2).*sin(q3))+((-1).*cos(q1).* ...
  cos(q3).*sin(q2)+sin(q1).*sin(q3)).*((DZ+L1).*(1+(-1).*cos(q4))+(-1).* ...
  DY.*sin(q4))+cos(q1).*cos(q2).*(DY.*(1+(-1).*cos(q4))+(DZ+L1).*sin(q4))+ ...
  (DZ+L1).*(cos(q4).*((-1).*cos(q1).*cos(q3).*sin(q2)+sin(q1).*sin(q3))+( ...
  -1).*cos(q1).*cos(q2).*sin(q4))+DY.*(cos(q1).*cos(q2).*cos(q4)+((-1).* ...
  cos(q1).*cos(q3).*sin(q2)+sin(q1).*sin(q3)).*sin(q4));(-1).*cos(q2).* ...
  sin(q3),cos(q4).*sin(q2)+cos(q2).*cos(q3).*sin(q4),cos(q2).*cos(q3).* ...
  cos(q4)+(-1).*sin(q2).*sin(q4),DZ.*(1+(-1).*cos(q2))+(-1).*DY.*sin(q2)+( ...
  -1).*DX.*cos(q2).*sin(q3)+cos(q2).*(DZ.*(1+(-1).*cos(q3))+DX.*sin(q3))+ ...
  cos(q2).*cos(q3).*((DZ+L1).*(1+(-1).*cos(q4))+(-1).*DY.*sin(q4))+sin(q2) ...
  .*(DY.*(1+(-1).*cos(q4))+(DZ+L1).*sin(q4))+DY.*(cos(q4).*sin(q2)+cos(q2) ...
  .*cos(q3).*sin(q4))+(DZ+L1).*(cos(q2).*cos(q3).*cos(q4)+(-1).*sin(q2).* ...
  sin(q4));0,0,0,1];
end

